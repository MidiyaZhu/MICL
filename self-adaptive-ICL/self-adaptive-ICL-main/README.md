build your datasets with each label for both validation and train set.

run prerank_myllama_splitlabel_test.py for both your validation and test sets retrievedlabel.

then

run retriever_llama_withlabel_test.py for test retrieved2label

then 

run retriever_llama_withlabel_valid.py for valid retrieved2 label